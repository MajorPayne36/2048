(this.webpackJsonp2048=this.webpackJsonp2048||[]).push([[0],{218:function(e,n,t){},29:function(e,n){e.exports={JOIN:"join",LEAVE:"leave",COUNT:"count",PRESENT:"present",SHARE_ROOMS:"share-rooms",ADD_PEER:"add-peer",REMOVE_PEER:"remove-peer",RELAY_SDP:"relay-sdp",RELAY_ICE:"relay-ice",ICE_CANDIDATE:"ice-candidate",SESSION_DESCRIPTION:"session-description"}},392:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t.n(r),a=t(27),o=t.n(a),i=(t(218),t(219),t(137)),u=t(21),s=t(38),f=t(208),l=t(399),j=t(400),d=t(73),O=function(e,n){for(var t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++)if(e[t][r]===n)return!0;return!1},b=function(){return[Math.floor(4*Math.random()),Math.floor(4*Math.random())]},h=function(e){if(function(e){return!O(e,0)}(e))return e;for(var n=b(),t=Object(s.a)(n,2),r=t[0],c=t[1];0!==e[r][c];){var a=b(),o=Object(s.a)(a,2);r=o[0],c=o[1]}return e[r][c]=2,e},p=function(e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],t=0;t<e.length;t++)for(var r=0,c=0;c<e[t].length;c++)0!==e[t][c]&&(n[t][r]=e[t][c],r++);return n},v=function(e){var n=function(e){for(var n=0;n<e.length;n++)for(var t=0;t<e[n].length-1;t++)0!==e[n][t]&&e[n][t]===e[n][t+1]&&(e[n][t]=2*e[n][t],e[n][t+1]=0);return e}(p(e));return p(n)},x=function(e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++)n[t][r]=e[t][e[t].length-1-r];return n},m=function(e){var n=x(e),t=v(n);return x(t)},E=function(e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++)n[t][r]=e[r][e[t].length-1-t];return n},g=function(e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++)n[t][r]=e[e[t].length-1-r][t];return n},I=function(e){var n=E(e),t=v(n);return g(t)},D=function(e){var n=g(e),t=v(n);return E(t)},k=function(e,n){for(var t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++)if(e[t][r]!==n[t][r])return!0;return!1},y=t(8),w=function(e){var n=e.number;return Object(y.jsx)("div",{className:"cell cell-".concat(n),children:n>0?n:""})},R=function(){var e=Object(r.useState)(h([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]])),n=Object(s.a)(e,2),t=n[0],c=n[1],a=function(){!function(e){return O(e,2048)}(t)?function(e){return!k(e,v(e))&&!k(e,m(e))&&!k(e,I(e))&&!k(e,D(e))}(t)&&f.b.error("Game over!"):f.b.success("You win!")},o=function(){var e=v(t);c(h(e)),a()},i=function(){var e=m(t);c(h(e)),a()},u=function(){var e=I(t);c(h(e)),a()},b=function(){var e=D(t);c(h(e)),a()},p=function(e){switch(e.key){case"ArrowLeft":o();break;case"ArrowRight":i();break;case"ArrowUp":u();break;case"ArrowDown":b()}};return Object(r.useEffect)((function(){return window.addEventListener("keydown",p),function(){window.removeEventListener("keydown",p)}})),Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)("div",{className:"game-board",children:[Object(y.jsx)(l.a,{children:Object(y.jsx)(j.a,{xs:{span:24,offset:0},xl:{span:10,offset:7},children:t.map((function(e,n){return Object(y.jsx)("div",{className:"row",children:e.map((function(e,t){return Object(y.jsx)(w,{number:e},"cell-".concat(n,"-").concat(t))}))},"row-".concat(n))}))})}),document.documentElement.scrollWidth<600?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(l.a,{children:Object(y.jsx)(j.a,{span:4,offset:10,children:Object(y.jsx)(d.a,{onClick:u,children:"\u0412\u0432\u0435\u0440\u0445"})})}),Object(y.jsxs)(l.a,{children:[Object(y.jsx)(j.a,{span:4,offset:6,children:Object(y.jsx)(d.a,{onClick:o,children:"\u041f\u0440\u0430\u0432\u043e"})}),Object(y.jsx)(j.a,{span:4,offset:4,children:Object(y.jsx)(d.a,{onClick:i,children:"\u041f\u0440\u0430\u0432\u043e"})})]}),Object(y.jsx)(l.a,{children:Object(y.jsx)(j.a,{span:4,offset:10,children:Object(y.jsx)(d.a,{onClick:b,children:"\u0412\u043d\u0438\u0437"})})})]}):null]})})},A=t(395),C=t(56),S=t(398),_=t(138),N=t(74),L=t.n(N),T=t(135),M=t(157),P=t(209),U=t(198),V=t.n(U),H=function(e){var n=Object(r.useState)(e),t=Object(s.a)(n,2),c=t[0],a=t[1],o=Object(r.useRef)(null),i=Object(r.useCallback)((function(e,n){o.current=n,a((function(n){return"function"===typeof e?e(n):e}))}),[]);return Object(r.useEffect)((function(){o.current&&(o.current(c),o.current=null)}),[c]),[c,i]},Y=t(199),F=Object(Y.io)("ws://video-guru-app-server.herokuapp.com",{"force new connection":!0,reconnectionAttempts:"Infinity",timeout:1e4,transports:["websocket"]}),J=t(29),z=t.n(J),W="LOCAL_VIDEO",B="LOCAL_AUDIO";function G(){var e=function(e){var n,t=H([]),c=Object(s.a)(t,2),a=c[0],o=c[1],i=Object(r.useCallback)((function(e,n){o((function(n){return n.includes(e)?n:[].concat(Object(P.a)(n),[e])}),n)}),[a,o]),u=Object(r.useRef)({}),l=(Object(r.useRef)(null),Object(r.useRef)(null)),j=Object(r.useRef)(null),d=Object(r.useRef)((n={},Object(M.a)(n,W,null),Object(M.a)(n,B,null),n));return Object(r.useEffect)((function(){function e(){return(e=Object(T.a)(L.a.mark((function e(n){var t,r,c,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.peerID,r=n.createOffer,!(t in u.current)){e.next=3;break}return e.abrupt("return",console.warn("Already connected to peer ".concat(t)));case 3:if(u.current[t]=new RTCPeerConnection({iceServers:V()()}),u.current[t].onicecandidate=function(e){e.candidate&&F.emit(z.a.RELAY_ICE,{peerID:t,iceCandidate:e.candidate})},c=0,u.current[t].ontrack=function(e){var n=Object(s.a)(e.streams,1)[0];1===++c&&(c=0,i(t,(function(){if(d.current[t])d.current[t].srcObject=n;else var e=!1,r=setInterval((function(){d.current[t]&&(d.current[t].srcObject=n,e=!0),e&&clearInterval(r)}),1e3)})))},j.current&&j.current.getTracks().forEach((function(e){u.current[t].addTrack(e,j.current)})),l.current&&l.current.getTracks().forEach((function(e){u.current[t].addTrack(e,l.current)})),!r){e.next=16;break}return e.next=12,u.current[t].createOffer();case 12:return a=e.sent,e.next=15,u.current[t].setLocalDescription(a);case 15:F.emit(z.a.RELAY_SDP,{peerID:t,sessionDescription:a});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return F.on(z.a.ADD_PEER,(function(n){return e.apply(this,arguments)})),function(){F.off(z.a.ADD_PEER)}}),[]),Object(r.useEffect)((function(){function e(){return(e=Object(T.a)(L.a.mark((function e(n){var t,r,c,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.peerID,c=n.sessionDescription,e.next=3,null===(t=u.current[r])||void 0===t?void 0:t.setRemoteDescription(new RTCSessionDescription(c));case 3:if("offer"!==c.type){e.next=10;break}return e.next=6,u.current[r].createAnswer();case 6:return a=e.sent,e.next=9,u.current[r].setLocalDescription(a);case 9:F.emit(z.a.RELAY_SDP,{peerID:r,sessionDescription:a});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return F.on(z.a.SESSION_DESCRIPTION,(function(n){return e.apply(this,arguments)})),function(){F.off(z.a.SESSION_DESCRIPTION)}}),[]),Object(r.useEffect)((function(){return F.on(z.a.ICE_CANDIDATE,(function(e){var n,t=e.peerID,r=e.iceCandidate;null===(n=u.current[t])||void 0===n||n.addIceCandidate(new RTCIceCandidate(r))})),function(){F.off(z.a.ICE_CANDIDATE)}}),[]),Object(r.useEffect)((function(){return F.on(z.a.REMOVE_PEER,(function(e){var n=e.peerID;u.current[n]&&u.current[n].close(),delete u.current[n],delete d.current[n],o((function(e){return e.filter((function(e){return e!==n}))}))})),function(){F.off(z.a.REMOVE_PEER)}}),[]),Object(r.useEffect)((function(){function n(){return(n=Object(T.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0}).catch((function(e){f.b.error("\u0423\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u0437\u0432\u0443\u043a\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"),console.error(e.name+": "+e.message)}));case 2:return j.current=e.sent,e.next=5,navigator.mediaDevices.getUserMedia({video:!0}).catch((function(e){f.b.error("\u0412\u0438\u0435\u043e\u043a\u0430\u043c\u0435\u0440\u0430 \u043d\u0435 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u043e"),console.error(e.name+": "+e.message)}));case 5:l.current=e.sent,i(W,(function(){var e=d.current.LOCAL_VIDEO,n=d.current.LOCAL_AUDIO;e&&(e.volume=0,e.srcObject=l.current),n&&(n.volume=0,n.srcObject=j.current)}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}().then((function(){return F.emit(z.a.JOIN,{room:e})})).catch((function(e){return console.error("Error getting userMedia:",e)})),function(){j.current&&j.current.getTracks().forEach((function(e){return e.stop()})),l.current&&l.current.getTracks().forEach((function(e){return e.stop()})),F.emit(z.a.LEAVE)}}),[e]),{clients:a,provideMediaRef:Object(r.useCallback)((function(e,n){d.current[e]=n}),[])}}(Object(u.g)().id),n=e.clients,t=e.provideMediaRef,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=Array.from({length:e}).reduce((function(e,n,t,r){return t%2===0&&e.push(r.slice(t,t+2)),e}),[]),t=n.length,r="".concat(100/t,"%");return n.map((function(e,n,t){return n===t.length-1&&1===e.length?[{width:"100%",height:r}]:e.map((function(){return{width:"50%",height:r}}))})).flat()}(n.length);return Object(y.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap",height:"100vh"},children:n.map((function(e,n){return Object(y.jsx)("div",{style:c[n],id:e,children:Object(y.jsx)("video",{width:"100%",height:"100%",ref:function(n){t(e,n)},autoPlay:!0,playsInline:!0,muted:e===W})},e)}))})}var q=t(401),K=t(402),Q=t(396),X=t(397);function Z(){var e=Object(u.f)(),n=Object(r.useState)([]),t=Object(s.a)(n,2),c=t[0],a=t[1],o=Object(r.useState)([]),i=Object(s.a)(o,2),f=i[0],l=i[1],j=Object(r.useRef)(),O=[{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",dataIndex:"name",key:"name"},{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:"count",key:"count"},{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435",dataIndex:"join",key:"join",render:function(n,t){return Object(y.jsx)(q.b,{size:"middle",children:Object(y.jsx)(d.a,{ghost:!0,type:"primary",onClick:function(){e.push("/room/".concat(t.name))},children:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0443"})})}}],b=c.map((function(e,n){return{key:n,name:e,count:Object(y.jsx)(K.a,{color:"blue",children:f[n]})}}));return Object(r.useEffect)((function(){F.on(z.a.SHARE_ROOMS,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.rooms,t=void 0===n?[]:n,r=e.count,c=void 0===r?[]:r;j.current&&(a(t),l(c),console.log(t),console.log(c))}))}),[]),Object(y.jsxs)("div",{ref:j,children:[Object(y.jsx)("h1",{children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u044b"}),Object(y.jsx)(Q.a,{dataSource:b,columns:O}),Object(y.jsx)(d.a,{type:"primary",onClick:function(){e.push("/room/".concat(Object(X.a)()))},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043a\u043e\u043c\u043d\u0430\u0442\u0443"})]})}function $(){return Object(y.jsx)("div",{children:"NOT FOUND."})}var ee=function(){return Object(y.jsx)(i.a,{children:Object(y.jsxs)(A.a,{children:[Object(y.jsxs)(_.Header,{style:{position:"fixed",zIndex:1,width:"100%"},children:[Object(y.jsx)("div",{className:"logo"}),Object(y.jsxs)(C.a,{theme:"dark",mode:"horizontal",children:[Object(y.jsx)(C.a.Item,{children:Object(y.jsx)(i.b,{to:"/",children:"Home"})},"1"),Object(y.jsx)(C.a.Item,{children:Object(y.jsx)(i.b,{to:"/2048",children:"2048"})},"2"),Object(y.jsx)(C.a.Item,{children:"nav 3"},"3")]})]}),Object(y.jsxs)(_.Content,{className:"site-layout",style:{padding:"0 50px",marginTop:64},children:[Object(y.jsxs)(S.a,{style:{margin:"16px 0"},children:[Object(y.jsx)(S.a.Item,{children:"Home"}),Object(y.jsx)(S.a.Item,{children:"List"}),Object(y.jsx)(S.a.Item,{children:"App"})]}),Object(y.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:380},children:Object(y.jsx)("div",{className:"App",children:Object(y.jsxs)(u.c,{children:[Object(y.jsx)(u.a,{exact:!0,path:"/room/:id",component:G}),Object(y.jsx)(u.a,{exact:!0,path:"/",component:Z}),Object(y.jsx)(u.a,{exact:!0,path:"/2048",component:R}),Object(y.jsx)(u.a,{component:$})]})})})]}),Object(y.jsx)(_.Footer,{style:{textAlign:"center"},children:"  \u0412\u0438\u0434\u0435\u043e\u0447\u0430\u0442. \u0421\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c \u0413\u0440\u0438\u0433\u043e\u0440\u044f\u043d \u0410\u043d\u0434\u0440\u0430\u043d\u0438\u043a. \u0412\u0413\u0422\u0423/\u0418\u0414-181"})]})})};o.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(ee,{})}),document.getElementById("root"))}},[[392,1,2]]]);
//# sourceMappingURL=main.6781edcf.chunk.js.map
(this.webpackJsonp2048=this.webpackJsonp2048||[]).push([[0],{218:function(e,t,n){},29:function(e,t){e.exports={JOIN:"join",LEAVE:"leave",COUNT:"count",PRESENT:"present",SHARE_ROOMS:"share-rooms",ADD_PEER:"add-peer",REMOVE_PEER:"remove-peer",RELAY_SDP:"relay-sdp",RELAY_ICE:"relay-ice",ICE_CANDIDATE:"ice-candidate",SESSION_DESCRIPTION:"session-description"}},392:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(27),o=n.n(a),i=(n(218),n(219),n(136)),u=n(21),s=n(38),f=n(208),l=n(399),j=n(400),d=n(73),b=function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(e[n][r]===t)return!0;return!1},h=function(){return[Math.floor(4*Math.random()),Math.floor(4*Math.random())]},O=function(e){if(function(e){return!b(e,0)}(e))return e;for(var t=h(),n=Object(s.a)(t,2),r=n[0],c=n[1];0!==e[r][c];){var a=h(),o=Object(s.a)(a,2);r=o[0],c=o[1]}return e[r][c]=2,e},p=function(e){for(var t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],n=0;n<e.length;n++)for(var r=0,c=0;c<e[n].length;c++)0!==e[n][c]&&(t[n][r]=e[n][c],r++);return t},x=function(e){var t=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length-1;n++)0!==e[t][n]&&e[t][n]===e[t][n+1]&&(e[t][n]=2*e[t][n],e[t][n+1]=0);return e}(p(e));return p(t)},v=function(e){for(var t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)t[n][r]=e[n][e[n].length-1-r];return t},m=function(e){var t=v(e),n=x(t);return v(n)},E=function(e){for(var t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)t[n][r]=e[r][e[n].length-1-n];return t},g=function(e){for(var t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)t[n][r]=e[e[n].length-1-r][n];return t},I=function(e){var t=E(e),n=x(t);return g(n)},w=function(e){var t=g(e),n=x(t);return E(n)},y=function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(e[n][r]!==t[n][r])return!0;return!1},D=n(8),R=function(e){var t=e.number;return Object(D.jsx)("div",{className:"cell cell-".concat(t),children:t>0?t:""})},C=function(){var e=Object(r.useState)(O([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]])),t=Object(s.a)(e,2),n=t[0],c=t[1],a=function(){!function(e){return b(e,2048)}(n)?function(e){return!y(e,x(e))&&!y(e,m(e))&&!y(e,I(e))&&!y(e,w(e))}(n)&&f.b.error("Game over!"):f.b.success("You win!")},o=function(){var e=x(n);c(O(e)),a()},i=function(){var e=m(n);c(O(e)),a()},u=function(){var e=I(n);c(O(e)),a()},h=function(){var e=w(n);c(O(e)),a()},p=function(e){switch(e.key){case"ArrowLeft":o();break;case"ArrowRight":i();break;case"ArrowUp":u();break;case"ArrowDown":h()}};return Object(r.useEffect)((function(){return window.addEventListener("keydown",p),function(){window.removeEventListener("keydown",p)}})),Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)("div",{className:"game-board",children:[Object(D.jsx)(l.a,{children:Object(D.jsx)(j.a,{xs:{span:24,offset:0},xl:{span:10,offset:7},children:n.map((function(e,t){return Object(D.jsx)("div",{className:"row",children:e.map((function(e,n){return Object(D.jsx)(R,{number:e},"cell-".concat(t,"-").concat(n))}))},"row-".concat(t))}))})}),document.documentElement.scrollWidth<600?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(l.a,{children:Object(D.jsx)(j.a,{span:4,offset:10,children:Object(D.jsx)(d.a,{onClick:u,children:"\u0412\u0432\u0435\u0440\u0445"})})}),Object(D.jsxs)(l.a,{children:[Object(D.jsx)(j.a,{span:4,offset:6,children:Object(D.jsx)(d.a,{onClick:o,children:"\u041f\u0440\u0430\u0432\u043e"})}),Object(D.jsx)(j.a,{span:4,offset:4,children:Object(D.jsx)(d.a,{onClick:i,children:"\u041f\u0440\u0430\u0432\u043e"})})]}),Object(D.jsx)(l.a,{children:Object(D.jsx)(j.a,{span:4,offset:10,children:Object(D.jsx)(d.a,{onClick:h,children:"\u0412\u043d\u0438\u0437"})})})]}):null]})})},k=n(395),A=n(56),S=n(398),N=n(137),_=n(74),L=n.n(_),T=n(134),P=n(197),M=n(209),V=n(198),H=n.n(V),Y=function(e){var t=Object(r.useState)(e),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(r.useRef)(null),i=Object(r.useCallback)((function(e,t){o.current=t,a((function(t){return"function"===typeof e?e(t):e}))}),[]);return Object(r.useEffect)((function(){o.current&&(o.current(c),o.current=null)}),[c]),[c,i]},F=n(199),J=Object(F.io)("ws://localhost:3001",{"force new connection":!0,reconnectionAttempts:"Infinity",timeout:1e4,transports:["websocket"]}),U=n(29),z=n.n(U),W="LOCAL_VIDEO";function B(){var e=function(e){var t=Y([]),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(r.useCallback)((function(e,t){a((function(t){return t.includes(e)?t:[].concat(Object(M.a)(t),[e])}),t)}),[c,a]),i=Object(r.useRef)({}),u=Object(r.useRef)(null),f=Object(r.useRef)(Object(P.a)({},W,null));return Object(r.useEffect)((function(){function e(){return(e=Object(T.a)(L.a.mark((function e(t){var n,r,c,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.peerID,r=t.createOffer,!(n in i.current)){e.next=3;break}return e.abrupt("return",console.warn("Already connected to peer ".concat(n)));case 3:if(i.current[n]=new RTCPeerConnection({iceServers:H()()}),i.current[n].onicecandidate=function(e){e.candidate&&J.emit(z.a.RELAY_ICE,{peerID:n,iceCandidate:e.candidate})},c=0,i.current[n].ontrack=function(e){var t=Object(s.a)(e.streams,1)[0];1===++c&&(c=0,o(n,(function(){if(f.current[n])f.current[n].srcObject=t;else var e=!1,r=setInterval((function(){f.current[n]&&(f.current[n].srcObject=t,e=!0),e&&clearInterval(r)}),1e3)})))},u.current.getTracks().forEach((function(e){i.current[n].addTrack(e,u.current)})),!r){e.next=15;break}return e.next=11,i.current[n].createOffer();case 11:return a=e.sent,e.next=14,i.current[n].setLocalDescription(a);case 14:J.emit(z.a.RELAY_SDP,{peerID:n,sessionDescription:a});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return J.on(z.a.ADD_PEER,(function(t){return e.apply(this,arguments)})),function(){J.off(z.a.ADD_PEER)}}),[]),Object(r.useEffect)((function(){function e(){return(e=Object(T.a)(L.a.mark((function e(t){var n,r,c,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.peerID,c=t.sessionDescription,e.next=3,null===(n=i.current[r])||void 0===n?void 0:n.setRemoteDescription(new RTCSessionDescription(c));case 3:if("offer"!==c.type){e.next=10;break}return e.next=6,i.current[r].createAnswer();case 6:return a=e.sent,e.next=9,i.current[r].setLocalDescription(a);case 9:J.emit(z.a.RELAY_SDP,{peerID:r,sessionDescription:a});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return J.on(z.a.SESSION_DESCRIPTION,(function(t){return e.apply(this,arguments)})),function(){J.off(z.a.SESSION_DESCRIPTION)}}),[]),Object(r.useEffect)((function(){return J.on(z.a.ICE_CANDIDATE,(function(e){var t,n=e.peerID,r=e.iceCandidate;null===(t=i.current[n])||void 0===t||t.addIceCandidate(new RTCIceCandidate(r))})),function(){J.off(z.a.ICE_CANDIDATE)}}),[]),Object(r.useEffect)((function(){return J.on(z.a.REMOVE_PEER,(function(e){var t=e.peerID;i.current[t]&&i.current[t].close(),delete i.current[t],delete f.current[t],a((function(e){return e.filter((function(e){return e!==t}))}))})),function(){J.off(z.a.REMOVE_PEER)}}),[]),Object(r.useEffect)((function(){function t(){return(t=Object(T.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:u.current=e.sent,o(W,(function(){var e=f.current.LOCAL_VIDEO;e&&(e.volume=0,e.srcObject=u.current)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){return t.apply(this,arguments)}().then((function(){return J.emit(z.a.JOIN,{room:e})})).catch((function(e){return console.error("Error getting userMedia:",e)})),function(){u.current.getTracks().forEach((function(e){return e.stop()})),J.emit(z.a.LEAVE)}}),[e]),{clients:c,provideMediaRef:Object(r.useCallback)((function(e,t){f.current[e]=t}),[])}}(Object(u.g)().id),t=e.clients,n=e.provideMediaRef,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Array.from({length:e}).reduce((function(e,t,n,r){return n%2===0&&e.push(r.slice(n,n+2)),e}),[]),n=t.length,r="".concat(100/n,"%");return t.map((function(e,t,n){return t===n.length-1&&1===e.length?[{width:"100%",height:r}]:e.map((function(){return{width:"50%",height:r}}))})).flat()}(t.length);return Object(D.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap",height:"100vh"},children:t.map((function(e,t){return Object(D.jsx)("div",{style:c[t],id:e,children:Object(D.jsx)("video",{width:"100%",height:"100%",ref:function(t){n(e,t)},autoPlay:!0,playsInline:!0,muted:e===W})},e)}))})}var G=n(401),K=n(402),q=n(396),Q=n(397);function X(){var e=Object(u.f)(),t=Object(r.useState)([]),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(r.useState)([]),i=Object(s.a)(o,2),f=i[0],l=i[1],j=Object(r.useRef)(),b=[{title:"Name",dataIndex:"name",key:"name"},{title:"Count",dataIndex:"count",key:"count"},{title:"join",dataIndex:"join",key:"join",render:function(t,n){return Object(D.jsx)(G.b,{size:"middle",children:Object(D.jsx)(d.a,{ghost:!0,type:"primary",onClick:function(){e.push("/room/".concat(n.name))},children:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0443"})})}}],h=c.map((function(e,t){return{key:t,name:e,count:Object(D.jsx)(K.a,{color:"blue",children:f[t]})}}));return Object(r.useEffect)((function(){J.on(z.a.SHARE_ROOMS,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rooms,n=void 0===t?[]:t,r=e.count,c=void 0===r?[]:r;j.current&&(a(n),l(c),console.log(n),console.log(c))}))}),[]),Object(D.jsxs)("div",{ref:j,children:[Object(D.jsx)("h1",{children:"Available Rooms"}),Object(D.jsx)(q.a,{dataSource:h,columns:b}),";",Object(D.jsx)(d.a,{onClick:function(){e.push("/room/".concat(Object(Q.a)()))},children:"Create New Room"})]})}function Z(){return Object(D.jsx)("div",{children:"NOT FOUND."})}var $=function(){return Object(D.jsx)(i.a,{children:Object(D.jsxs)(k.a,{children:[Object(D.jsxs)(N.Header,{style:{position:"fixed",zIndex:1,width:"100%"},children:[Object(D.jsx)("div",{className:"logo"}),Object(D.jsxs)(A.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["2"],children:[Object(D.jsx)(A.a.Item,{children:Object(D.jsx)(i.b,{to:"/",children:"Home"})},"1"),Object(D.jsx)(A.a.Item,{children:Object(D.jsx)(i.b,{to:"/2048",children:"2048"})},"2"),Object(D.jsx)(A.a.Item,{children:"nav 3"},"3")]})]}),Object(D.jsxs)(N.Content,{className:"site-layout",style:{padding:"0 50px",marginTop:64},children:[Object(D.jsxs)(S.a,{style:{margin:"16px 0"},children:[Object(D.jsx)(S.a.Item,{children:"Home"}),Object(D.jsx)(S.a.Item,{children:"List"}),Object(D.jsx)(S.a.Item,{children:"App"})]}),Object(D.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:380},children:Object(D.jsx)("div",{className:"App",children:Object(D.jsxs)(u.c,{children:[Object(D.jsx)(u.a,{exact:!0,path:"/room/:id",component:B}),Object(D.jsx)(u.a,{exact:!0,path:"/",component:X}),Object(D.jsx)(u.a,{exact:!0,path:"/2048",component:C}),Object(D.jsx)(u.a,{component:Z})]})})})]}),Object(D.jsx)(N.Footer,{style:{textAlign:"center"},children:"  \u0412\u0438\u0434\u0435\u043e\u0447\u0430\u0442. \u0421\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c \u0413\u0440\u0438\u0433\u043e\u0440\u044f\u043d \u0410\u043d\u0434\u0440\u0430\u043d\u0438\u043a. \u0412\u0413\u0422\u0423/\u0418\u0414-181"})]})})};o.a.render(Object(D.jsx)(c.a.StrictMode,{children:Object(D.jsx)($,{})}),document.getElementById("root"))}},[[392,1,2]]]);
//# sourceMappingURL=main.6cc69042.chunk.js.map